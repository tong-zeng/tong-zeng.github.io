<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tong Zeng">
<meta name="dcterms.date" content="2023-11-15">
<meta name="description" content="House prices prediction with linear and nonlinear models">

<title>Linear and Nonlinear Regression – Tong Zeng</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../blogs/classification/index.html" rel="next">
<link href="../../blogs/clustering/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=GTM-TKJ3X4RT"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'GTM-TKJ3X4RT', { 'anonymize_ip': false});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Tong Zeng</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../#news"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../#publications"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blogs.html"> 
<span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tong-zeng/tong-zeng.github.io"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/zeng_tong"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:tongzeng@vt.edu"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Linear and Nonlinear Regression</h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Linear and Nonlinear Regression</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                  <div>
        <div class="description">
          House prices prediction with linear and nonlinear models
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Regression</div>
                <div class="quarto-category">Deep Learning</div>
                <div class="quarto-category">Supervised Learning</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tong Zeng </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 15, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Blogs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blogs/clustering/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blogs/regression/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Linear and Nonlinear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blogs/classification/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blogs/probability/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability Theory and Random Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blogs/welcome/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to Machine Learning Blog</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blogs/anomaly-detection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anomaly Detection</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#import-libraries" id="toc-import-libraries" class="nav-link" data-scroll-target="#import-libraries">Import Libraries</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load Data</a></li>
  <li><a href="#correlation-coefficient" id="toc-correlation-coefficient" class="nav-link" data-scroll-target="#correlation-coefficient">Correlation Coefficient</a></li>
  </ul></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing">Preprocessing</a></li>
  <li><a href="#data-split" id="toc-data-split" class="nav-link" data-scroll-target="#data-split">Data Split</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation">Evaluation</a>
  <ul class="collapse">
  <li><a href="#rmse" id="toc-rmse" class="nav-link" data-scroll-target="#rmse"><strong>RMSE</strong></a></li>
  <li><a href="#r-squared-r²-score" id="toc-r-squared-r²-score" class="nav-link" data-scroll-target="#r-squared-r²-score"><strong>R-Squared (R²) Score</strong></a></li>
  <li><a href="#evaluation-using-sklearn" id="toc-evaluation-using-sklearn" class="nav-link" data-scroll-target="#evaluation-using-sklearn">Evaluation using Sklearn</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-models" id="toc-linear-models" class="nav-link" data-scroll-target="#linear-models">Linear Models</a>
  <ul>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a>
  <ul class="collapse">
  <li><a href="#training" id="toc-training" class="nav-link" data-scroll-target="#training"><strong>Training</strong></a></li>
  <li><a href="#interpreting" id="toc-interpreting" class="nav-link" data-scroll-target="#interpreting"><strong>Interpreting</strong></a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><strong>Prediction</strong></a></li>
  <li><a href="#performance" id="toc-performance" class="nav-link" data-scroll-target="#performance">Performance</a></li>
  </ul></li>
  <li><a href="#ridge-regression" id="toc-ridge-regression" class="nav-link" data-scroll-target="#ridge-regression">Ridge Regression</a></li>
  <li><a href="#lasso-regression" id="toc-lasso-regression" class="nav-link" data-scroll-target="#lasso-regression">Lasso Regression</a></li>
  <li><a href="#elastic-net-regression" id="toc-elastic-net-regression" class="nav-link" data-scroll-target="#elastic-net-regression">Elastic Net Regression</a></li>
  </ul></li>
  <li><a href="#nonlinear-models" id="toc-nonlinear-models" class="nav-link" data-scroll-target="#nonlinear-models">Nonlinear Models</a>
  <ul>
  <li><a href="#polynomial-regression" id="toc-polynomial-regression" class="nav-link" data-scroll-target="#polynomial-regression">Polynomial Regression</a>
  <ul class="collapse">
  <li><a href="#modeling-1" id="toc-modeling-1" class="nav-link" data-scroll-target="#modeling-1">Modeling</a></li>
  <li><a href="#performance-1" id="toc-performance-1" class="nav-link" data-scroll-target="#performance-1">Performance</a></li>
  </ul></li>
  <li><a href="#artificial-neural-network" id="toc-artificial-neural-network" class="nav-link" data-scroll-target="#artificial-neural-network">Artificial Neural Network</a>
  <ul class="collapse">
  <li><a href="#network-construction" id="toc-network-construction" class="nav-link" data-scroll-target="#network-construction">Network Construction</a></li>
  <li><a href="#training-1" id="toc-training-1" class="nav-link" data-scroll-target="#training-1">Training</a></li>
  <li><a href="#evaluation-1" id="toc-evaluation-1" class="nav-link" data-scroll-target="#evaluation-1">Evaluation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#discussion-and-conclusion" id="toc-discussion-and-conclusion" class="nav-link" data-scroll-target="#discussion-and-conclusion">Discussion and Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<div class="column-screen">
<img src="img/regression.jpg" class="content-header-full-img img-fluid">
<p style="text-align:right; font-size:0.66em">
Image source: https://www.freepik.com
</p>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this blog, we’re going to solve the House Prices Prediction problem with linear and nonlinear regression models. Regression is one of the most important machine learning (ML) algorithm, it is very straightforward and intuitive. It is usually the first algorithm we encounter in our machine learning journey, so let’s conquer it together!</p>
<p>We’re going to cover the following regression models in this post:</p>
<ul>
<li>Linear Models
<ul>
<li>Linear Regression</li>
<li>Ridge Regression</li>
<li>Lasso Regression</li>
<li>Elastic Net Regression</li>
</ul></li>
<li>Nonlinear Models
<ul>
<li>Polynomial Regression</li>
<li>Artificial Neural Network</li>
</ul></li>
</ul>
</section>
<section id="data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>The dataset used in this blog is downloaded from <a href="https://www.kaggle.com/datasets/vedavyasv/usa-housing?select=USA_Housing.csv">Kaggle USA Housing</a>. The whole dataset is about 5000 rows and 7 columns stored in the csv format, a local downloaded copy could be found as <a href="data/USA_Housing.csv">USA_Housing.csv</a> file.</p>
<section id="exploratory-data-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h3>
<p>We first conduct some exploratory data analysis. We’re going to use the pandas library to load and process data, and use the matplotlib and seaborn library for data visualizations.</p>
<section id="import-libraries" class="level4">
<h4 class="anchored" data-anchor-id="import-libraries">Import Libraries</h4>
<div id="79256d4d" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hvplot.pandas</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="load-data">Load Data</h4>
<div class="cell tbl-column-page" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>housing_df <span class="op">=</span> pd.read_csv(<span class="st">'data/USA_Housing.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>housing_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-head-of-dataset" class="cell tbl-column-page quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="2">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-head-of-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Samples of the dataset
</figcaption>
<div aria-describedby="tbl-head-of-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe do-not-create-environment cell tbl-column-page caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Avg. Area Income</th>
<th data-quarto-table-cell-role="th">Avg. Area House Age</th>
<th data-quarto-table-cell-role="th">Avg. Area Number of Rooms</th>
<th data-quarto-table-cell-role="th">Avg. Area Number of Bedrooms</th>
<th data-quarto-table-cell-role="th">Area Population</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Address</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>79545.458574</td>
<td>5.682861</td>
<td>7.009188</td>
<td>4.09</td>
<td>23086.800503</td>
<td>1.059034e+06</td>
<td>208 Michael Ferry Apt. 674\nLaurabury, NE 3701...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>79248.642455</td>
<td>6.002900</td>
<td>6.730821</td>
<td>3.09</td>
<td>40173.072174</td>
<td>1.505891e+06</td>
<td>188 Johnson Views Suite 079\nLake Kathleen, CA...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>61287.067179</td>
<td>5.865890</td>
<td>8.512727</td>
<td>5.13</td>
<td>36882.159400</td>
<td>1.058988e+06</td>
<td>9127 Elizabeth Stravenue\nDanieltown, WI 06482...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>63345.240046</td>
<td>7.188236</td>
<td>5.586729</td>
<td>3.26</td>
<td>34310.242831</td>
<td>1.260617e+06</td>
<td>USS Barnett\nFPO AP 44820</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>59982.197226</td>
<td>5.040555</td>
<td>7.839388</td>
<td>4.23</td>
<td>26354.109472</td>
<td>6.309435e+05</td>
<td>USNS Raymond\nFPO AE 09386</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>As we can see in the <a href="#tbl-head-of-dataset" class="quarto-xref">Table&nbsp;1</a>, there are 6 numeric columns represents the average area income, house age, number of rooms, number of bedrooms, area population and price, respectively. There is only 1 textual column, keeps the house address.</p>
<p>Our goal is modeling the house price, so it should be the dependent variable in the regressions, and all the other columns should be treated as the independent variable.</p>
<p>We now have a quick examination of the descriptive statistics.</p>
<div id="7fdd769d" class="cell page-columns page-full" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>housing_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display column-body-outset" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Avg. Area Income</th>
<th data-quarto-table-cell-role="th">Avg. Area House Age</th>
<th data-quarto-table-cell-role="th">Avg. Area Number of Rooms</th>
<th data-quarto-table-cell-role="th">Avg. Area Number of Bedrooms</th>
<th data-quarto-table-cell-role="th">Area Population</th>
<th data-quarto-table-cell-role="th">Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>5000.000000</td>
<td>5000.000000</td>
<td>5000.000000</td>
<td>5000.000000</td>
<td>5000.000000</td>
<td>5.000000e+03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>68583.108984</td>
<td>5.977222</td>
<td>6.987792</td>
<td>3.981330</td>
<td>36163.516039</td>
<td>1.232073e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>10657.991214</td>
<td>0.991456</td>
<td>1.005833</td>
<td>1.234137</td>
<td>9925.650114</td>
<td>3.531176e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>17796.631190</td>
<td>2.644304</td>
<td>3.236194</td>
<td>2.000000</td>
<td>172.610686</td>
<td>1.593866e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>61480.562388</td>
<td>5.322283</td>
<td>6.299250</td>
<td>3.140000</td>
<td>29403.928702</td>
<td>9.975771e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>68804.286404</td>
<td>5.970429</td>
<td>7.002902</td>
<td>4.050000</td>
<td>36199.406689</td>
<td>1.232669e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>75783.338666</td>
<td>6.650808</td>
<td>7.665871</td>
<td>4.490000</td>
<td>42861.290769</td>
<td>1.471210e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>107701.748378</td>
<td>9.519088</td>
<td>10.759588</td>
<td>6.500000</td>
<td>69621.713378</td>
<td>2.469066e+06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In order to have better insights on the variables, we further visualize the data distributions as follows.</p>
<div id="cell-fig-data-distr" class="cell page-columns page-full" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(housing_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display page-columns page-full">
<div id="fig-data-distr" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-data-distr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="index_files/figure-html/fig-data-distr-output-1.png" width="1416" height="1415" class="figure-img column-page">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-distr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The data distribution of variables
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>As <a href="#tbl-head-of-dataset" class="quarto-xref">Table&nbsp;1</a> shows, most of our variables are normal distributed, except for the average number of bedrooms, there is clearly some linear trends between the dependent variable <code>Price</code> and other variables.</p>
<div id="d85da44b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>housing_df.hvplot.hist(<span class="st">'Price'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We further examine the relations between the dependent variable, for instance, we plot the relationship between <code>Price</code> and <code>Avg. Area Income</code> interactively as below.</p>
<div id="53fb8d43" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>housing_df.hvplot.scatter(x<span class="op">=</span><span class="st">'Avg. Area Income'</span>, y<span class="op">=</span><span class="st">'Price'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-coefficient" class="level4">
<h4 class="anchored" data-anchor-id="correlation-coefficient">Correlation Coefficient</h4>
<div id="cell-fig-corr" class="cell fig-cap-location-bottom" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7" data-cap-location="bottom"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>axes_arr <span class="op">=</span> sns.heatmap(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  housing_df[[</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    col <span class="cf">for</span> col <span class="kw">in</span> housing_df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"Address"</span>,<span class="st">"Price"</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    ]].corr()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-corr" class="quarto-float quarto-figure quarto-figure-center anchored" data-cap-location="bottom">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-corr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-corr-output-1.png" width="731" height="614" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The plot of Correlation Coefficient
</figcaption>
</figure>
</div>
</div>
</div>
<p>As it is clearly shown in <a href="#fig-corr" class="quarto-xref">Figure&nbsp;2</a>, the <code>Avg. Area Income</code> is most correlated with <code>Price</code>, followed by <code>Avg. Area House Age</code>, <code>Area Population</code>, <code>Avg. Area Number of Rooms</code>. The variable <code>Avg. Area Number of Bedrooms</code> has the smallest correlation score at 0.17. Thus, we will include all these variables in the modeling section.</p>
</section>
</section>
<section id="preprocessing" class="level3">
<h3 class="anchored" data-anchor-id="preprocessing">Preprocessing</h3>
<p>In order to fully exploit the linear regression, especially for better interpretability, we have to check if our data satisfies some criteria for linear regression application. For example:</p>
<ul>
<li><p>Linear Assumption. The linear regression models assume there are linear relationship between the dependent variable and independent variables.</p></li>
<li><p>Noise Removal. The noises (i.e., missing value, outliers) in data could potentially impair the model performance, we have to remove these noise before modeling.</p></li>
<li><p>Gaussian Distribution. Linear regression works well with data comply with gaussian distribution. For those not, we have to apply data transformation techniques (e.g., log transform, BoxCox) to make the data more gaussian distributed.</p></li>
<li><p>Variable Scaling. If variable values are at different magnitudes, we need to scale them to the same magnitudes by using standardization or normalization.</p></li>
</ul>
<p>We have already tested the linear assumption and gaussian distribution in the exploratory data analysis section. And the data is relatively clean, noise is not a problem, however, the value of variables are at different magnitude, we will perform re-scaling before modeling steps.</p>
<div id="196820c1" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'std_scalar'</span>, StandardScaler())</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> housing_df[[</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    col <span class="cf">for</span> col <span class="kw">in</span> housing_df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"Address"</span>,<span class="st">"Price"</span>] </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> housing_df[<span class="st">'Price'</span>].to_numpy()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> pipeline.fit_transform(X)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(X_scaled).describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>5.000000e+03</td>
<td>5.000000e+03</td>
<td>5.000000e+03</td>
<td>5.000000e+03</td>
<td>5.000000e+03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>-2.167155e-17</td>
<td>4.263256e-18</td>
<td>-4.135359e-16</td>
<td>-2.088996e-16</td>
<td>-3.041123e-16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1.000100e+00</td>
<td>1.000100e+00</td>
<td>1.000100e+00</td>
<td>1.000100e+00</td>
<td>1.000100e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-4.765584e+00</td>
<td>-3.361975e+00</td>
<td>-3.730214e+00</td>
<td>-1.605598e+00</td>
<td>-3.626413e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-6.664724e-01</td>
<td>-6.606490e-01</td>
<td>-6.846171e-01</td>
<td>-6.817833e-01</td>
<td>-6.810902e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2.075434e-02</td>
<td>-6.852312e-03</td>
<td>1.502401e-02</td>
<td>5.564767e-02</td>
<td>3.616311e-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>6.756386e-01</td>
<td>6.794590e-01</td>
<td>6.742146e-01</td>
<td>4.122077e-01</td>
<td>6.748621e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.670725e+00</td>
<td>3.572745e+00</td>
<td>3.750297e+00</td>
<td>2.041039e+00</td>
<td>3.371219e+00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-split" class="level3">
<h3 class="anchored" data-anchor-id="data-split">Data Split</h3>
<p>Before the modeling steps, we first the dataset into train, validation and test split. We will use sklearn to perform this task.</p>
<div id="7e680009" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">666</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0c070a84" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The size of train split: </span><span class="sc">{</span><span class="bu">len</span>(X_train)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The size of test split: </span><span class="sc">{</span><span class="bu">len</span>(X_test)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The size of train split: 4000
The size of test split: 1000</code></pre>
</div>
</div>
</section>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>In this section, we will first introduce the model evaluation metrics and then modeling the data using various of regression algorithms.</p>
<section id="evaluation" class="level3">
<h3 class="anchored" data-anchor-id="evaluation">Evaluation</h3>
<p>There are several popular evaluation metrics which are widely used in regression problem.</p>
<section id="rmse" class="level4">
<h4 class="anchored" data-anchor-id="rmse"><strong>RMSE</strong></h4>
<p><strong>Root Mean Squared Error</strong> (RMSE) is the square root of the mean of the squared errors:</p>
<p><span class="math display">
\operatorname{RMSE}= \sqrt{\frac{1}{n}\sum_{i=1}^n(\hat{y_i} - y_i)^2}
</span></p>
<p>where,</p>
<ul>
<li><p><span class="math inline">x_i</span> = independent variable of each data point</p></li>
<li><p><span class="math inline">y_i</span> = dependent variable of each data point</p></li>
<li><p><span class="math inline">\bar{y}</span> = mean of <span class="math inline">y</span> value</p></li>
<li><p><span class="math inline">\hat{y_i}</span> = the predict <span class="math inline">y</span> value base on <span class="math inline">x</span></p></li>
</ul>
</section>
<section id="r-squared-r²-score" class="level4">
<h4 class="anchored" data-anchor-id="r-squared-r²-score"><strong>R-Squared (R²) Score</strong></h4>
<p><span class="math inline">R^2</span> describes the proportion of dependent variance explained by the regression model<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. It could be denoted by the following equation.</p>
<p><span class="math display">
\operatorname{R^2} = \frac{SSR}{SST}
</span></p>
<p>where,</p>
<ul>
<li><p><span class="math inline">SSR = \sum_{i=1}^n \left(\hat{y_i} - \bar{y}\right)^2</span></p></li>
<li><p><span class="math inline">\operatorname{SST} = \sum_{i=1}^n \left(y_i - \bar{y}\right)^2</span></p></li>
</ul>
</section>
<section id="evaluation-using-sklearn" class="level4">
<h4 class="anchored" data-anchor-id="evaluation-using-sklearn">Evaluation using Sklearn</h4>
<div id="184013a4" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_evaluate(true, predicted):  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    rmse <span class="op">=</span> np.sqrt(metrics.mean_squared_error(true, predicted))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    r2_square <span class="op">=</span> metrics.r2_score(true, predicted)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'RMSE:'</span>, rmse)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'R2 Square'</span>, r2_square)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'__________________________________'</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate(true, predicted):</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    rmse <span class="op">=</span> np.sqrt(metrics.mean_squared_error(true, predicted))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    r2_square <span class="op">=</span> metrics.r2_score(true, predicted)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rmse, r2_square</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="linear-models" class="level2">
<h2 class="anchored" data-anchor-id="linear-models">Linear Models</h2>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear Regression</h3>
<p>We now train a linear regression model using sklearn library.</p>
<section id="training" class="level4">
<h4 class="anchored" data-anchor-id="training"><strong>Training</strong></h4>
<div id="153b487e" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>linear_md <span class="op">=</span> LinearRegression()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>linear_md.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
<p>After the fit, we completed the model train. The next step is verify the fitting result and evaluate the model performance.</p>
</section>
<section id="interpreting" class="level4">
<h4 class="anchored" data-anchor-id="interpreting"><strong>Interpreting</strong></h4>
<p>We can access the model intercept and coefficients using the sklearn API:</p>
<div id="b6a1f586" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The intercept is: </span><span class="sc">{</span>linear_md<span class="sc">.</span>intercept_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>coef_df <span class="op">=</span> pd.DataFrame(linear_md.coef_, X.columns, columns<span class="op">=</span>[<span class="st">'Coefficient'</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>coef_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The intercept is: 1232604.4076491522</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Avg. Area Income</td>
<td>230982.846988</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Avg. Area House Age</td>
<td>162799.384625</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Avg. Area Number of Rooms</td>
<td>122310.560876</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Avg. Area Number of Bedrooms</td>
<td>2376.796391</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Area Population</td>
<td>151198.049691</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="prediction" class="level4">
<h4 class="anchored" data-anchor-id="prediction"><strong>Prediction</strong></h4>
<p>Predict using the model</p>
<div id="c5ec998a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> linear_md.predict(X_test)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'True Values'</span>: y_test, <span class="st">'Predicted Values'</span>: pred}).hvplot.scatter(x<span class="op">=</span><span class="st">'True Values'</span>, y<span class="op">=</span><span class="st">'Predicted Values'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div id="p1004">
  <div id="f71f5f76-c832-4ef6-a66f-cd4d2fe52597" data-root-id="p1004" style="display: contents;"></div>
</div>
<script type="application/javascript">(function(root) {
  var docs_json = {"2d82552e-1e1c-43a1-b954-33c4dfb3ddba":{"version":"3.3.2","title":"Bokeh Application","roots":[{"type":"object","name":"Row","id":"p1004","attributes":{"name":"Row01122","tags":["embedded"],"stylesheets":["\n:host(.pn-loading.pn-arc):before, .pn-loading.pn-arc:before {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPiAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzNjM2MzIiBzdHJva2Utd2lkdGg9IjEwIiByPSIzNSIgc3Ryb2tlLWRhc2hhcnJheT0iMTY0LjkzMzYxNDMxMzQ2NDE1IDU2Ljk3Nzg3MTQzNzgyMTM4Ij4gICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjFzIiB2YWx1ZXM9IjAgNTAgNTA7MzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIj48L2FuaW1hdGVUcmFuc2Zvcm0+ICA8L2NpcmNsZT48L3N2Zz4=\");\n  background-size: auto calc(min(50%, 400px));\n}",{"type":"object","name":"ImportedStyleSheet","id":"p1007","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/css/loading.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1063","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/css/listpanel.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1005","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/bundled/theme/default.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1006","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/bundled/theme/native.css"}}],"min_width":700,"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"Spacer","id":"p1008","attributes":{"name":"HSpacer01133","stylesheets":["\n:host(.pn-loading.pn-arc):before, .pn-loading.pn-arc:before {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPiAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzNjM2MzIiBzdHJva2Utd2lkdGg9IjEwIiByPSIzNSIgc3Ryb2tlLWRhc2hhcnJheT0iMTY0LjkzMzYxNDMxMzQ2NDE1IDU2Ljk3Nzg3MTQzNzgyMTM4Ij4gICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjFzIiB2YWx1ZXM9IjAgNTAgNTA7MzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIj48L2FuaW1hdGVUcmFuc2Zvcm0+ICA8L2NpcmNsZT48L3N2Zz4=\");\n  background-size: auto calc(min(50%, 400px));\n}",{"id":"p1007"},{"id":"p1005"},{"id":"p1006"}],"margin":0,"sizing_mode":"stretch_width","align":"start"}},{"type":"object","name":"Figure","id":"p1016","attributes":{"width":700,"height":300,"margin":[5,10],"sizing_mode":"fixed","align":"start","x_range":{"type":"object","name":"Range1d","id":"p1009","attributes":{"tags":[[["True Values","True Values",null]],[]],"start":204279.11013116973,"end":2419555.875603583,"reset_start":204279.11013116973,"reset_end":2419555.875603583}},"y_range":{"type":"object","name":"Range1d","id":"p1010","attributes":{"tags":[[["Predicted Values","Predicted Values",null]],{"type":"map","entries":[["invert_yaxis",false],["autorange",false]]}],"start":23419.906372766593,"end":2702260.4246553183,"reset_start":23419.906372766593,"reset_end":2702260.4246553183}},"x_scale":{"type":"object","name":"LinearScale","id":"p1026"},"y_scale":{"type":"object","name":"LinearScale","id":"p1027"},"title":{"type":"object","name":"Title","id":"p1019","attributes":{"text_color":"black","text_font_size":"12pt"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1056","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1047","attributes":{"selected":{"type":"object","name":"Selection","id":"p1048","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1049"},"data":{"type":"map","entries":[["True Values",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[1000],"dtype":"float64","order":"little"}],["Predicted Values",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[1000],"dtype":"float64","order":"little"}],["True_Values",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[1000],"dtype":"float64","order":"little"}],["Predicted_Values",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[1000],"dtype":"float64","order":"little"}]]}}},"view":{"type":"object","name":"CDSView","id":"p1057","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1058"}}},"glyph":{"type":"object","name":"Scatter","id":"p1053","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"True Values"},"y":{"type":"field","field":"Predicted Values"},"size":{"type":"value","value":5.477225575051661},"line_color":{"type":"value","value":"#30a2da"},"fill_color":{"type":"value","value":"#30a2da"},"hatch_color":{"type":"value","value":"#30a2da"}}},"selection_glyph":{"type":"object","name":"Scatter","id":"p1059","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"True Values"},"y":{"type":"field","field":"Predicted Values"},"size":{"type":"value","value":5.477225575051661},"angle":{"type":"value","value":0.0},"line_color":{"type":"value","value":"#30a2da"},"line_alpha":{"type":"value","value":1.0},"line_width":{"type":"value","value":1},"line_join":{"type":"value","value":"bevel"},"line_cap":{"type":"value","value":"butt"},"line_dash":{"type":"value","value":[]},"line_dash_offset":{"type":"value","value":0},"fill_color":{"type":"value","value":"#30a2da"},"fill_alpha":{"type":"value","value":1.0},"hatch_color":{"type":"value","value":"#30a2da"},"hatch_alpha":{"type":"value","value":1.0},"hatch_scale":{"type":"value","value":12.0},"hatch_pattern":{"type":"value","value":null},"hatch_weight":{"type":"value","value":1.0},"marker":{"type":"value","value":"circle"}}},"nonselection_glyph":{"type":"object","name":"Scatter","id":"p1054","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"True Values"},"y":{"type":"field","field":"Predicted Values"},"size":{"type":"value","value":5.477225575051661},"line_color":{"type":"value","value":"#30a2da"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"#30a2da"},"fill_alpha":{"type":"value","value":0.1},"hatch_color":{"type":"value","value":"#30a2da"},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Scatter","id":"p1055","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"True Values"},"y":{"type":"field","field":"Predicted Values"},"size":{"type":"value","value":5.477225575051661},"line_color":{"type":"value","value":"#30a2da"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"#30a2da"},"fill_alpha":{"type":"value","value":0.2},"hatch_color":{"type":"value","value":"#30a2da"},"hatch_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1025","attributes":{"tools":[{"type":"object","name":"WheelZoomTool","id":"p1014","attributes":{"tags":["hv_created"],"renderers":"auto","zoom_together":"none"}},{"type":"object","name":"HoverTool","id":"p1015","attributes":{"tags":["hv_created"],"renderers":[{"id":"p1056"}],"tooltips":[["True Values","@{True_Values}"],["Predicted Values","@{Predicted_Values}"]]}},{"type":"object","name":"SaveTool","id":"p1038"},{"type":"object","name":"PanTool","id":"p1039"},{"type":"object","name":"BoxZoomTool","id":"p1040","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1041","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"ResetTool","id":"p1046"}],"active_drag":{"id":"p1039"},"active_scroll":{"id":"p1014"}}},"left":[{"type":"object","name":"LinearAxis","id":"p1033","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1034","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1035"},"axis_label":"Predicted Values","major_label_policy":{"type":"object","name":"AllLabels","id":"p1036"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1028","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1029","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1030"},"axis_label":"True Values","major_label_policy":{"type":"object","name":"AllLabels","id":"p1031"}}}],"center":[{"type":"object","name":"Grid","id":"p1032","attributes":{"axis":{"id":"p1028"},"grid_line_color":null}},{"type":"object","name":"Grid","id":"p1037","attributes":{"dimension":1,"axis":{"id":"p1033"},"grid_line_color":null}}],"min_border_top":10,"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"output_backend":"webgl"}},{"type":"object","name":"Spacer","id":"p1061","attributes":{"name":"HSpacer01136","stylesheets":["\n:host(.pn-loading.pn-arc):before, .pn-loading.pn-arc:before {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPiAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzNjM2MzIiBzdHJva2Utd2lkdGg9IjEwIiByPSIzNSIgc3Ryb2tlLWRhc2hhcnJheT0iMTY0LjkzMzYxNDMxMzQ2NDE1IDU2Ljk3Nzg3MTQzNzgyMTM4Ij4gICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjFzIiB2YWx1ZXM9IjAgNTAgNTA7MzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIj48L2FuaW1hdGVUcmFuc2Zvcm0+ICA8L2NpcmNsZT48L3N2Zz4=\");\n  background-size: auto calc(min(50%, 400px));\n}",{"id":"p1007"},{"id":"p1005"},{"id":"p1006"}],"margin":0,"sizing_mode":"stretch_width","align":"start"}}]}}],"defs":[{"type":"model","name":"ReactiveHTML1"},{"type":"model","name":"FlexBox1","properties":[{"name":"align_content","kind":"Any","default":"flex-start"},{"name":"align_items","kind":"Any","default":"flex-start"},{"name":"flex_direction","kind":"Any","default":"row"},{"name":"flex_wrap","kind":"Any","default":"wrap"},{"name":"justify_content","kind":"Any","default":"flex-start"}]},{"type":"model","name":"FloatPanel1","properties":[{"name":"config","kind":"Any","default":{"type":"map"}},{"name":"contained","kind":"Any","default":true},{"name":"position","kind":"Any","default":"right-top"},{"name":"offsetx","kind":"Any","default":null},{"name":"offsety","kind":"Any","default":null},{"name":"theme","kind":"Any","default":"primary"},{"name":"status","kind":"Any","default":"normalized"}]},{"type":"model","name":"GridStack1","properties":[{"name":"mode","kind":"Any","default":"warn"},{"name":"ncols","kind":"Any","default":null},{"name":"nrows","kind":"Any","default":null},{"name":"allow_resize","kind":"Any","default":true},{"name":"allow_drag","kind":"Any","default":true},{"name":"state","kind":"Any","default":[]}]},{"type":"model","name":"drag1","properties":[{"name":"slider_width","kind":"Any","default":5},{"name":"slider_color","kind":"Any","default":"black"},{"name":"value","kind":"Any","default":50}]},{"type":"model","name":"click1","properties":[{"name":"terminal_output","kind":"Any","default":""},{"name":"debug_name","kind":"Any","default":""},{"name":"clears","kind":"Any","default":0}]},{"type":"model","name":"toggle_value1","properties":[{"name":"active_icons","kind":"Any","default":{"type":"map"}},{"name":"options","kind":"Any","default":{"type":"map","entries":[["favorite","heart"]]}},{"name":"value","kind":"Any","default":[]},{"name":"_reactions","kind":"Any","default":[]},{"name":"_base_url","kind":"Any","default":"https://tabler-icons.io/static/tabler-icons/icons/"}]},{"type":"model","name":"copy_to_clipboard1","properties":[{"name":"value","kind":"Any","default":null},{"name":"fill","kind":"Any","default":"none"}]},{"type":"model","name":"FastWrapper1","properties":[{"name":"object","kind":"Any","default":null},{"name":"style","kind":"Any","default":null}]},{"type":"model","name":"NotificationAreaBase1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0}]},{"type":"model","name":"NotificationArea1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"notifications","kind":"Any","default":[]},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0},{"name":"types","kind":"Any","default":[{"type":"map","entries":[["type","warning"],["background","#ffc107"],["icon",{"type":"map","entries":[["className","fas fa-exclamation-triangle"],["tagName","i"],["color","white"]]}]]},{"type":"map","entries":[["type","info"],["background","#007bff"],["icon",{"type":"map","entries":[["className","fas fa-info-circle"],["tagName","i"],["color","white"]]}]]}]}]},{"type":"model","name":"Notification","properties":[{"name":"background","kind":"Any","default":null},{"name":"duration","kind":"Any","default":3000},{"name":"icon","kind":"Any","default":null},{"name":"message","kind":"Any","default":""},{"name":"notification_type","kind":"Any","default":null},{"name":"_destroyed","kind":"Any","default":false}]},{"type":"model","name":"TemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"BootstrapTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"MaterialTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]}]}};
  var render_items = [{"docid":"2d82552e-1e1c-43a1-b954-33c4dfb3ddba","roots":{"p1004":"f71f5f76-c832-4ef6-a66f-cd4d2fe52597"},"root_ids":["p1004"]}];
  var docs = Object.values(docs_json)
  if (!docs) {
    return
  }
  const py_version = docs[0].version.replace('rc', '-rc.').replace('.dev', '-dev.')
  function embed_document(root) {
    var Bokeh = get_bokeh(root)
    Bokeh.embed.embed_items_notebook(docs_json, render_items);
    for (const render_item of render_items) {
      for (const root_id of render_item.root_ids) {
    const id_el = document.getElementById(root_id)
    if (id_el.children.length && (id_el.children[0].className === 'bk-root')) {
      const root_el = id_el.children[0]
      root_el.id = root_el.id + '-rendered'
    }
      }
    }
  }
  function get_bokeh(root) {
    if (root.Bokeh === undefined) {
      return null
    } else if (root.Bokeh.version !== py_version) {
      if (root.Bokeh.versions === undefined || !root.Bokeh.versions.has(py_version)) {
    return null
      }
      return root.Bokeh.versions.get(py_version);
    } else if (root.Bokeh.version === py_version) {
      return root.Bokeh
    }
    return null
  }
  function is_loaded(root) {
    var Bokeh = get_bokeh(root)
    return (Bokeh != null && Bokeh.Panel !== undefined)
  }
  if (is_loaded(root)) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (is_loaded(root)) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
      var Bokeh = get_bokeh(root)
      if (Bokeh == null || Bokeh.Panel == null) {
            console.warn("Panel: ERROR: Unable to run Panel code because Bokeh or Panel library is missing");
      } else {
        console.warn("Panel: WARNING: Attempting to render but not all required libraries could be resolved.")
        embed_document(root)
      }
        }
      }
    }, 25, root)
  }
})(window);</script>
</div>
</div>
<p>The residual histogram is plotted as following:</p>
<div id="01b3ff66" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'Error Values'</span>: (y_test <span class="op">-</span> pred)}).hvplot.kde()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div id="p1069">
  <div id="be742e85-f238-4b19-b456-4f563be4be3f" data-root-id="p1069" style="display: contents;"></div>
</div>
<script type="application/javascript">(function(root) {
  var docs_json = {"457168ae-df91-4b5e-83bd-46dfa7bbb971":{"version":"3.3.2","title":"Bokeh Application","roots":[{"type":"object","name":"Row","id":"p1069","attributes":{"name":"Row01265","tags":["embedded"],"stylesheets":["\n:host(.pn-loading.pn-arc):before, .pn-loading.pn-arc:before {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPiAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzNjM2MzIiBzdHJva2Utd2lkdGg9IjEwIiByPSIzNSIgc3Ryb2tlLWRhc2hhcnJheT0iMTY0LjkzMzYxNDMxMzQ2NDE1IDU2Ljk3Nzg3MTQzNzgyMTM4Ij4gICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjFzIiB2YWx1ZXM9IjAgNTAgNTA7MzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIj48L2FuaW1hdGVUcmFuc2Zvcm0+ICA8L2NpcmNsZT48L3N2Zz4=\");\n  background-size: auto calc(min(50%, 400px));\n}",{"type":"object","name":"ImportedStyleSheet","id":"p1072","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/css/loading.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1128","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/css/listpanel.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1070","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/bundled/theme/default.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1071","attributes":{"url":"https://cdn.holoviz.org/panel/1.3.4/dist/bundled/theme/native.css"}}],"min_width":700,"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"Spacer","id":"p1073","attributes":{"name":"HSpacer01276","stylesheets":["\n:host(.pn-loading.pn-arc):before, .pn-loading.pn-arc:before {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPiAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzNjM2MzIiBzdHJva2Utd2lkdGg9IjEwIiByPSIzNSIgc3Ryb2tlLWRhc2hhcnJheT0iMTY0LjkzMzYxNDMxMzQ2NDE1IDU2Ljk3Nzg3MTQzNzgyMTM4Ij4gICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjFzIiB2YWx1ZXM9IjAgNTAgNTA7MzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIj48L2FuaW1hdGVUcmFuc2Zvcm0+ICA8L2NpcmNsZT48L3N2Zz4=\");\n  background-size: auto calc(min(50%, 400px));\n}",{"id":"p1072"},{"id":"p1070"},{"id":"p1071"}],"margin":0,"sizing_mode":"stretch_width","align":"start"}},{"type":"object","name":"Figure","id":"p1081","attributes":{"width":700,"height":300,"margin":[5,10],"sizing_mode":"fixed","align":"start","x_range":{"type":"object","name":"Range1d","id":"p1074","attributes":{"tags":[[["Error Values","Error Values",null]],[]],"start":-414948.2749908401,"end":365729.4099380821,"reset_start":-414948.2749908401,"reset_end":365729.4099380821}},"y_range":{"type":"object","name":"Range1d","id":"p1075","attributes":{"tags":[[["Error Values_density","Density",null]],{"type":"map","entries":[["invert_yaxis",false],["autorange",false]]}],"end":4.1279098039152775e-06,"reset_start":0.0,"reset_end":4.1279098039152775e-06}},"x_scale":{"type":"object","name":"LinearScale","id":"p1091"},"y_scale":{"type":"object","name":"LinearScale","id":"p1092"},"title":{"type":"object","name":"Title","id":"p1084","attributes":{"text_color":"black","text_font_size":"12pt"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1121","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1112","attributes":{"selected":{"type":"object","name":"Selection","id":"p1113","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1114"},"data":{"type":"map","entries":[["x",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[200],"dtype":"float64","order":"little"}],["y",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[200],"dtype":"float64","order":"little"}]]}}},"view":{"type":"object","name":"CDSView","id":"p1122","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1123"}}},"glyph":{"type":"object","name":"Patch","id":"p1118","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"fill_color":"#30a2da","fill_alpha":0.5,"hatch_color":"#30a2da"}},"selection_glyph":{"type":"object","name":"Patch","id":"p1124","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"fill_color":"#30a2da","fill_alpha":0.5,"hatch_color":"#30a2da"}},"nonselection_glyph":{"type":"object","name":"Patch","id":"p1119","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_alpha":1,"fill_color":"#30a2da","fill_alpha":0.5,"hatch_color":"#30a2da","hatch_alpha":0.1}},"muted_glyph":{"type":"object","name":"Patch","id":"p1120","attributes":{"tags":["apply_ranges"],"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_alpha":0.2,"fill_color":"#30a2da","fill_alpha":0.2,"hatch_color":"#30a2da","hatch_alpha":0.2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1090","attributes":{"tools":[{"type":"object","name":"WheelZoomTool","id":"p1079","attributes":{"tags":["hv_created"],"renderers":"auto","zoom_together":"none"}},{"type":"object","name":"HoverTool","id":"p1080","attributes":{"tags":["hv_created"],"renderers":[{"id":"p1121"}],"tooltips":[["Error Values","@{Error_Values}"],["Density","@{Error_Values_density}"]]}},{"type":"object","name":"SaveTool","id":"p1103"},{"type":"object","name":"PanTool","id":"p1104"},{"type":"object","name":"BoxZoomTool","id":"p1105","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1106","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"ResetTool","id":"p1111"}],"active_drag":{"id":"p1104"},"active_scroll":{"id":"p1079"}}},"left":[{"type":"object","name":"LinearAxis","id":"p1098","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1099","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1100"},"axis_label":"Density","major_label_policy":{"type":"object","name":"AllLabels","id":"p1101"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1093","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1094","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1095"},"axis_label":"Error Values","major_label_policy":{"type":"object","name":"AllLabels","id":"p1096"}}}],"center":[{"type":"object","name":"Grid","id":"p1097","attributes":{"axis":{"id":"p1093"},"grid_line_color":null}},{"type":"object","name":"Grid","id":"p1102","attributes":{"dimension":1,"axis":{"id":"p1098"},"grid_line_color":null}}],"min_border_top":10,"min_border_bottom":10,"min_border_left":10,"min_border_right":10,"output_backend":"webgl"}},{"type":"object","name":"Spacer","id":"p1126","attributes":{"name":"HSpacer01279","stylesheets":["\n:host(.pn-loading.pn-arc):before, .pn-loading.pn-arc:before {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPiAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzNjM2MzIiBzdHJva2Utd2lkdGg9IjEwIiByPSIzNSIgc3Ryb2tlLWRhc2hhcnJheT0iMTY0LjkzMzYxNDMxMzQ2NDE1IDU2Ljk3Nzg3MTQzNzgyMTM4Ij4gICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjFzIiB2YWx1ZXM9IjAgNTAgNTA7MzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIj48L2FuaW1hdGVUcmFuc2Zvcm0+ICA8L2NpcmNsZT48L3N2Zz4=\");\n  background-size: auto calc(min(50%, 400px));\n}",{"id":"p1072"},{"id":"p1070"},{"id":"p1071"}],"margin":0,"sizing_mode":"stretch_width","align":"start"}}]}}],"defs":[{"type":"model","name":"ReactiveHTML1"},{"type":"model","name":"FlexBox1","properties":[{"name":"align_content","kind":"Any","default":"flex-start"},{"name":"align_items","kind":"Any","default":"flex-start"},{"name":"flex_direction","kind":"Any","default":"row"},{"name":"flex_wrap","kind":"Any","default":"wrap"},{"name":"justify_content","kind":"Any","default":"flex-start"}]},{"type":"model","name":"FloatPanel1","properties":[{"name":"config","kind":"Any","default":{"type":"map"}},{"name":"contained","kind":"Any","default":true},{"name":"position","kind":"Any","default":"right-top"},{"name":"offsetx","kind":"Any","default":null},{"name":"offsety","kind":"Any","default":null},{"name":"theme","kind":"Any","default":"primary"},{"name":"status","kind":"Any","default":"normalized"}]},{"type":"model","name":"GridStack1","properties":[{"name":"mode","kind":"Any","default":"warn"},{"name":"ncols","kind":"Any","default":null},{"name":"nrows","kind":"Any","default":null},{"name":"allow_resize","kind":"Any","default":true},{"name":"allow_drag","kind":"Any","default":true},{"name":"state","kind":"Any","default":[]}]},{"type":"model","name":"drag1","properties":[{"name":"slider_width","kind":"Any","default":5},{"name":"slider_color","kind":"Any","default":"black"},{"name":"value","kind":"Any","default":50}]},{"type":"model","name":"click1","properties":[{"name":"terminal_output","kind":"Any","default":""},{"name":"debug_name","kind":"Any","default":""},{"name":"clears","kind":"Any","default":0}]},{"type":"model","name":"toggle_value1","properties":[{"name":"active_icons","kind":"Any","default":{"type":"map"}},{"name":"options","kind":"Any","default":{"type":"map","entries":[["favorite","heart"]]}},{"name":"value","kind":"Any","default":[]},{"name":"_reactions","kind":"Any","default":[]},{"name":"_base_url","kind":"Any","default":"https://tabler-icons.io/static/tabler-icons/icons/"}]},{"type":"model","name":"copy_to_clipboard1","properties":[{"name":"value","kind":"Any","default":null},{"name":"fill","kind":"Any","default":"none"}]},{"type":"model","name":"FastWrapper1","properties":[{"name":"object","kind":"Any","default":null},{"name":"style","kind":"Any","default":null}]},{"type":"model","name":"NotificationAreaBase1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0}]},{"type":"model","name":"NotificationArea1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"notifications","kind":"Any","default":[]},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0},{"name":"types","kind":"Any","default":[{"type":"map","entries":[["type","warning"],["background","#ffc107"],["icon",{"type":"map","entries":[["className","fas fa-exclamation-triangle"],["tagName","i"],["color","white"]]}]]},{"type":"map","entries":[["type","info"],["background","#007bff"],["icon",{"type":"map","entries":[["className","fas fa-info-circle"],["tagName","i"],["color","white"]]}]]}]}]},{"type":"model","name":"Notification","properties":[{"name":"background","kind":"Any","default":null},{"name":"duration","kind":"Any","default":3000},{"name":"icon","kind":"Any","default":null},{"name":"message","kind":"Any","default":""},{"name":"notification_type","kind":"Any","default":null},{"name":"_destroyed","kind":"Any","default":false}]},{"type":"model","name":"TemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"BootstrapTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"MaterialTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]}]}};
  var render_items = [{"docid":"457168ae-df91-4b5e-83bd-46dfa7bbb971","roots":{"p1069":"be742e85-f238-4b19-b456-4f563be4be3f"},"root_ids":["p1069"]}];
  var docs = Object.values(docs_json)
  if (!docs) {
    return
  }
  const py_version = docs[0].version.replace('rc', '-rc.').replace('.dev', '-dev.')
  function embed_document(root) {
    var Bokeh = get_bokeh(root)
    Bokeh.embed.embed_items_notebook(docs_json, render_items);
    for (const render_item of render_items) {
      for (const root_id of render_item.root_ids) {
    const id_el = document.getElementById(root_id)
    if (id_el.children.length && (id_el.children[0].className === 'bk-root')) {
      const root_el = id_el.children[0]
      root_el.id = root_el.id + '-rendered'
    }
      }
    }
  }
  function get_bokeh(root) {
    if (root.Bokeh === undefined) {
      return null
    } else if (root.Bokeh.version !== py_version) {
      if (root.Bokeh.versions === undefined || !root.Bokeh.versions.has(py_version)) {
    return null
      }
      return root.Bokeh.versions.get(py_version);
    } else if (root.Bokeh.version === py_version) {
      return root.Bokeh
    }
    return null
  }
  function is_loaded(root) {
    var Bokeh = get_bokeh(root)
    return (Bokeh != null && Bokeh.Panel !== undefined)
  }
  if (is_loaded(root)) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (is_loaded(root)) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
      var Bokeh = get_bokeh(root)
      if (Bokeh == null || Bokeh.Panel == null) {
            console.warn("Panel: ERROR: Unable to run Panel code because Bokeh or Panel library is missing");
      } else {
        console.warn("Panel: WARNING: Attempting to render but not all required libraries could be resolved.")
        embed_document(root)
      }
        }
      }
    }, 25, root)
  }
})(window);</script>
</div>
</div>
</section>
<section id="performance" class="level4">
<h4 class="anchored" data-anchor-id="performance">Performance</h4>
<div id="b40f4a53" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> linear_md.predict(X_train)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> linear_md.predict(X_test)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The train set performance:

RMSE: 100782.52384490197
R2 Square 0.9178558419818683
__________________________________
The test set performance:

RMSE: 102440.81503100201
R2 Square 0.9184591335733732
__________________________________</code></pre>
</div>
</div>
</section>
</section>
<section id="ridge-regression" class="level3">
<h3 class="anchored" data-anchor-id="ridge-regression">Ridge Regression</h3>
<p>Ridge regression is a type of regularized linear regression, it imposes a penalty on the size of the coefficients, it could be expressed using the equation<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<p><span class="math display">
\min_{w} || X w - y||_2^2 + \alpha ||w||_2^2
</span></p>
<p>The parameter <span class="math inline">\alpha</span> controls the amount of the penalty, the larger the <span class="math inline">\alpha</span>, the more penalty is imposed, the coefficient is more shrink to 0.</p>
<p>Similar to linear regression, we do modeling and evaluation using the ridge regression as following:</p>
<div id="8ee182d5" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ridge_md <span class="op">=</span> Ridge(alpha <span class="op">=</span> <span class="dv">20</span>,  solver<span class="op">=</span><span class="st">'cholesky'</span>,  tol<span class="op">=</span><span class="fl">0.0001</span>, random_state<span class="op">=</span><span class="dv">666</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ridge_md.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Ridge(alpha=20, random_state=666, solver='cholesky')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">Ridge</label><div class="sk-toggleable__content"><pre>Ridge(alpha=20, random_state=666, solver='cholesky')</pre></div></div></div></div></div>
</div>
</div>
<div id="a3acafc2" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> ridge_md.predict(X_train)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> ridge_md.predict(X_test)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The train set performance:

RMSE: 100798.00734362529
R2 Square 0.9178305999732655
__________________________________
The test set performance:

RMSE: 102413.21431785727
R2 Square 0.9185030668996456
__________________________________</code></pre>
</div>
</div>
</section>
<section id="lasso-regression" class="level3">
<h3 class="anchored" data-anchor-id="lasso-regression">Lasso Regression</h3>
<p>Ridge regression is another type of regularized linear regression, specifically, using L1 regularization. It adds the absolute value of the coefficient to the loss function as the penalty. Mathematically, it could be expressed using the equation<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>:</p>
<p><span class="math display">
\min_{w} { \frac{1}{2n_{\text{samples}}} ||X w - y||_2 ^ 2 + \alpha ||w||_1}
</span></p>
<p>The parameter <span class="math inline">\alpha</span> is a constant which controls the amount of the penalty, the <span class="math inline">||w||_1</span> is the <span class="math inline">\ell_1</span>-norm of the coefficients.</p>
<p>Lasso Regression modeling and performance evaluation is performed bellow:</p>
<div id="af833ff6" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>lasso_md <span class="op">=</span> Lasso(alpha <span class="op">=</span> <span class="fl">0.08</span>, selection<span class="op">=</span><span class="st">'random'</span>, positive<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">888</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>lasso_md.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Lasso(alpha=0.08, positive=True, random_state=888, selection='random')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">Lasso</label><div class="sk-toggleable__content"><pre>Lasso(alpha=0.08, positive=True, random_state=888, selection='random')</pre></div></div></div></div></div>
</div>
</div>
<div id="bbc0c21e" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> lasso_md.predict(X_train)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> lasso_md.predict(X_test)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The train set performance:

RMSE: 100782.52384504011
R2 Square 0.917855841981643
__________________________________
The test set performance:

RMSE: 102440.81373676285
R2 Square 0.9184591356337508
__________________________________</code></pre>
</div>
</div>
</section>
<section id="elastic-net-regression" class="level3">
<h3 class="anchored" data-anchor-id="elastic-net-regression">Elastic Net Regression</h3>
<p>Elastic net regression is essentially a combination of Ridge and Lasso regression. As it adds two regularization term: L2 and L1 regularization which is used in Ridge and Lasso regression respectively. The trade-off between Ridge and Lasso allows elastic net regression picks up the advantages of these two models. The lost function is written as<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>:</p>
<p><span class="math display">
\min_{w}{\frac{1}{2n_{samples}} \big|\big|X w - y\big|\big|_2 ^ 2 + \alpha \rho \big|\big|w\big|\big|_1 + \frac{\alpha(1-\rho)}{2} \big|\big|w\big|\big|_2 ^ 2}
</span></p>
<p>The parameters <code>alpha</code> <span class="math inline">\alpha</span> and <code>l1_ratio</code> <span class="math inline">\rho</span> could be decided by cross-validation.</p>
<div id="cee83c14" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> ElasticNet</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>enet_md <span class="op">=</span> ElasticNet(alpha<span class="op">=</span><span class="fl">0.08</span>, l1_ratio<span class="op">=</span><span class="fl">0.9</span>, selection<span class="op">=</span><span class="st">'random'</span>, random_state<span class="op">=</span><span class="dv">666</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>enet_md.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<style>#sk-container-id-4 {color: black;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ElasticNet(alpha=0.08, l1_ratio=0.9, random_state=666, selection='random')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked=""><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">ElasticNet</label><div class="sk-toggleable__content"><pre>ElasticNet(alpha=0.08, l1_ratio=0.9, random_state=666, selection='random')</pre></div></div></div></div></div>
</div>
</div>
<div id="c32f49df" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> enet_md.predict(X_train)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> enet_md.predict(X_test)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The train set performance:

RMSE: 100821.89673708729
R2 Square 0.9177916466289507
__________________________________
The test set performance:

RMSE: 102411.86137925804
R2 Square 0.9185052201299478
__________________________________</code></pre>
</div>
</div>
</section>
</section>
<section id="nonlinear-models" class="level2">
<h2 class="anchored" data-anchor-id="nonlinear-models">Nonlinear Models</h2>
<p>All the model introduce above are belong to linear category. However, linear models is not designed to capture nonlinear trends in the data. If the relationship between dependent variable and independent variables are not linear, we have to apply nonlinear models. Among various options, polynomial regression and artificial neural network are the popular ones.</p>
<section id="polynomial-regression" class="level3">
<h3 class="anchored" data-anchor-id="polynomial-regression">Polynomial Regression</h3>
<p>Polynomial regression is a extension to linear regression by introducing polynomial terms. Recall the linear regression model looks like<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>:</p>
<p><span class="math display">
\hat{y}(w, x) = w_0 + w_1 x_1 + w_2 x_2
</span></p>
<p>However, we can add quadratic term to the previous equation to fit a parabola instead of a plane, then it looks like:</p>
<p><span class="math display">
    \hat{y}(w, x) = w_0 + w_1 x_1 + w_2 x_2 + w_3 x_1 x_2 + w_4 x_1^2 + w_5 x_2^2
</span></p>
<p>We can new image creating a set of features as:</p>
<p><span class="math display">
z = [x_1, x_2, x_1 x_2, x_1^2, x_2^2]
</span></p>
<p>Then, we combine the features and coefficients linearly, and get the following:</p>
<p><span class="math display">
\hat{y}(w, z) = w_0 + w_1 z_1 + w_2 z_2 + w_3 z_3 + w_4 z_4 + w_5 z_5
</span></p>
<section id="modeling-1" class="level4">
<h4 class="anchored" data-anchor-id="modeling-1">Modeling</h4>
<div id="4dbd7cd3" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>poly_md <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>X_train_2_d <span class="op">=</span> poly_md.fit_transform(X_train)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>X_test_2_d <span class="op">=</span> poly_md.transform(X_test)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>linear_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>linear_reg.fit(X_train_2_d, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked=""><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
</section>
<section id="performance-1" class="level4">
<h4 class="anchored" data-anchor-id="performance-1">Performance</h4>
<div id="dcfe52e9" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> linear_reg.predict(X_train_2_d)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> linear_reg.predict(X_test_2_d)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The train set performance:

RMSE: 100640.24459847226
R2 Square 0.9180876115116245
__________________________________
The test set performance:

RMSE: 102720.10827633881
R2 Square 0.918013903645979
__________________________________</code></pre>
</div>
</div>
</section>
</section>
<section id="artificial-neural-network" class="level3">
<h3 class="anchored" data-anchor-id="artificial-neural-network">Artificial Neural Network</h3>
<p>Artificial Neural Network is a very powerful model to fit linear and nonlinear data. In this section, we will use pytorch framework to build a artificial neural network to predict the house prices. Similar to previous models, we start from build the network, then train the models and report the performance in the end.</p>
<section id="network-construction" class="level4">
<h4 class="anchored" data-anchor-id="network-construction">Network Construction</h4>
<p>Import the libraries:</p>
<div id="3cc50303" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> Dataset, DataLoader</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Define the <code>HousePriceDataset</code> by extending pytorch’s <code>Dataset</code> class, it is simply convert the numpy array to pytorch tensor.</p>
<div id="3fcbcd38" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HousePriceDataset(Dataset):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, X, Y):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.X <span class="op">=</span> torch.tensor(X, dtype<span class="op">=</span>torch.float32)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.y <span class="op">=</span> torch.tensor(Y, dtype<span class="op">=</span>torch.float32)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.X)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, index):</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="va">self</span>.X[index], <span class="va">self</span>.y[index])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We new create the <code>DataLoader</code> objects, which load the data in batch to feed into the neural network.</p>
<div id="695b6221" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>train_ds <span class="op">=</span> HousePriceDataset(X_train, y_train)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>test_ds <span class="op">=</span> HousePriceDataset(X_test, y_test)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>trainloader <span class="op">=</span> DataLoader(train_ds, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                         num_workers<span class="op">=</span><span class="dv">2</span>, drop_last<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>testloader <span class="op">=</span> DataLoader(test_ds, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">True</span>, num_workers<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                        drop_last<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code below creates the neural network. It consist of several feed-forward layer with dropout regularization and use RELU as activate function. Each layer is like a linear regression, and the activate function map the output into the nonlinear space. That is why neural network could be used as a nonlinear regressor.</p>
<div id="371a4ff7" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MLP(nn.Module):</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">super</span>(MLP, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.layers <span class="op">=</span> nn.Sequential(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">5</span>, <span class="dv">64</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        nn.Dropout(<span class="fl">0.2</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        nn.ReLU(),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">64</span>, <span class="dv">128</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        nn.Dropout(<span class="fl">0.2</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        nn.ReLU(),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">128</span>, <span class="dv">64</span>),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>        nn.Dropout(<span class="fl">0.2</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        nn.ReLU(),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">64</span>, <span class="dv">1</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.layers(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="training-1" class="level4">
<h4 class="anchored" data-anchor-id="training-1">Training</h4>
<p>We first implement the evaluate function which loads the test data, pass it to the pre-trained model and reports the <code>MSE</code> and <span class="math inline">R^2</span> as performance metrics.</p>
<div id="3280266d" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate(model):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    pred_list <span class="op">=</span> []</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    label_list <span class="op">=</span> []</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    loss_list <span class="op">=</span> []</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    loss_function <span class="op">=</span> nn.MSELoss()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, data <span class="kw">in</span> <span class="bu">enumerate</span>(testloader):</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get inputs</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        inputs, targets <span class="op">=</span> data</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform forward pass</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> outputs.squeeze(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> loss_function(outputs, targets)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        loss_list.append(loss.item())</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        pred_list.append(outputs.detach().numpy())</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        label_list.append(targets.numpy())</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    avg_loss <span class="op">=</span> <span class="bu">sum</span>(loss_list) <span class="op">/</span> <span class="bu">len</span>(testloader)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    pred_np <span class="op">=</span> np.vstack(pred_list)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    label_np <span class="op">=</span> np.vstack(label_list)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    avg_r2 <span class="op">=</span> metrics.r2_score(pred_np, label_np)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (avg_loss, avg_r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The then implements the train function to manage the whole training process, it initialize the neural network, data loader, loss function and the optimizer. Data is passed forward in the network and errors are propagated backward in the network.</p>
<div id="7363333a" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train():</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    mlp <span class="op">=</span> MLP()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    torch.manual_seed(<span class="dv">666</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    trainloader <span class="op">=</span> DataLoader(train_ds, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                             num_workers<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    loss_function <span class="op">=</span> nn.MSELoss()</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(mlp.parameters(), lr<span class="op">=</span><span class="fl">6e-4</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    n_epochs <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    mlp.train()</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    train_loss_list <span class="op">=</span> []</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    train_r2_list <span class="op">=</span> []</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    test_loss_list <span class="op">=</span> []</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    test_r2_list <span class="op">=</span> []</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(n_epochs):</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        pred_list <span class="op">=</span> []</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        label_list <span class="op">=</span> []</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>        loss_list <span class="op">=</span> []</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, data <span class="kw">in</span> <span class="bu">enumerate</span>(trainloader):</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>            inputs, targets <span class="op">=</span> data</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Zero the gradients</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Perform forward pass</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> mlp(inputs)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> outputs.squeeze(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Compute loss</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_function(outputs, targets)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Perform backward pass</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Perform optimizationd</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Print statistics    </span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>            pred_list.append(outputs.detach().numpy())</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>            label_list.append(targets.numpy())</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>            loss_list.append(loss.item())</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>        avg_loss <span class="op">=</span> <span class="bu">sum</span>(loss_list) <span class="op">/</span> <span class="bu">len</span>(trainloader)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>        pred_np <span class="op">=</span> np.vstack(pred_list)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>        label_np <span class="op">=</span> np.vstack(label_list)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>        avg_r2 <span class="op">=</span> metrics.r2_score(pred_np, label_np)</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>        train_loss_list.append(avg_loss)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>        train_r2_list.append(avg_r2)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>        test_loss, test_r2 <span class="op">=</span> evaluate(mlp)</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>        test_loss_list.append(test_loss)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>        test_r2_list.append(test_r2)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"epoch: </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">, test_loss: </span><span class="sc">{</span>test_loss<span class="sc">}</span><span class="ss">, test_r2: </span><span class="sc">{</span>test_r2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Training process has finished.'</span>)</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mlp, train_loss_list, train_r2_list, test_loss_list, test_r2_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Start the training process:</p>
<div id="472c8bc0" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model, train_loss_list, train_r2_list, test_loss_list, test_r2_list <span class="op">=</span> train()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluation-1" class="level4">
<h4 class="anchored" data-anchor-id="evaluation-1">Evaluation</h4>
<p>Similar to previous model, we reports the <code>RMSE</code> and <code>R^2</code> of the test set as the evaluation metrics:</p>
<div id="8af29680" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>test_loss, test_r2 <span class="op">=</span> evaluate(model)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>rmse <span class="op">=</span> np.sqrt(test_loss)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'RMSE:'</span>, rmse)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'R2 Square'</span>, test_r2)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'__________________________________'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test set performance:

RMSE: 102623.80293089902
R2 Square 0.9047423651342836
__________________________________</code></pre>
</div>
</div>
<div id="ad49a34b" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>train_loss <span class="op">=</span> train_loss_list</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>val_loss <span class="op">=</span> test_loss_list</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>train_r2 <span class="op">=</span> train_r2_list</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>val_r2 <span class="op">=</span> test_r2_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Further, we can visualize the the <code>RMSE</code> of the train and test split during the whole training process, which is shown as follows:</p>
<div id="4d07cbc2" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw loss plot</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.plot(train_loss, label<span class="op">=</span><span class="st">'Training Loss'</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.plot(val_loss, label<span class="op">=</span><span class="st">'Validation Loss'</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Batch'</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Loss'</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-35-output-1.png" width="515" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The <span class="math inline">R^2</span> of the train and test split during the whole training process is shown as follows:</p>
<div id="bb1d1ff7" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw accuracy plot</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>plt.plot(train_r2[<span class="dv">10</span>:], label<span class="op">=</span><span class="st">'Training Accuracy'</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>plt.plot(val_r2[<span class="dv">10</span>:], label<span class="op">=</span><span class="st">'Validation Accuracy'</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Batch'</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Accuracy'</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-36-output-1.png" width="523" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="discussion-and-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="discussion-and-conclusion">Discussion and Conclusion</h2>
<p>In this blog, we applied 4 linear regression models and 2 nonlinear regression models in predicting the house price. Although trained on the same training set, these models vary in performance and have different characteristics in training.</p>
<p>Linear or nonlinear regression should I use? The choice between linear regression and nonlinear regression depends on the underlying relationship between the independent and dependent variables in your dataset. Here are some guidelines can be summarized from our previous experiments:</p>
<p><strong>Linearity of the Relationship:</strong></p>
<ul>
<li><p>Use linear regression when the relationship between the independent and dependent variables appears to be linear. Linear regression models assume a straight-line relationship, and they are suitable when the data points seem to follow a linear pattern.</p></li>
<li><p>Use nonlinear regression when the relationship is not linear. If the data exhibits a curve, exponential growth, decay, or any other nonlinear pattern, a nonlinear regression model may be more appropriate.</p></li>
</ul>
<p><strong>Model Complexity:</strong></p>
<ul>
<li><p>Linear regression models are simpler and easier to interpret. If a linear relationship adequately describes the data, it’s often preferable due to its simplicity.</p></li>
<li><p>Nonlinear regression models can capture more complex relationships but may be harder to interpret. Be cautious about overfitting, where a model captures noise in the data rather than the underlying pattern.</p></li>
</ul>
<p>As the house price data we used has a simple linear pattern, so, the performance is has no big difference than the nonlinear models. But it is much simple to implement and requires much less time and resource for training. In this kind of scenario, linear regression could be a good choice.</p>
<p>In summary, the decision to use linear or nonlinear regression depends on the characteristics of your data and the underlying relationship between variables.</p>


<!-- -->

</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://en.wikipedia.org/wiki/Coefficient_of_determination" class="uri">https://en.wikipedia.org/wiki/Coefficient_of_determination</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="https://scikit-learn.org/stable/modules/linear_model.html#ridge-regression" class="uri">https://scikit-learn.org/stable/modules/linear_model.html#ridge-regression</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html#sklearn.linear_model.Lasso" class="uri">https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html#sklearn.linear_model.Lasso</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html#sklearn.linear_model.ElasticNet" class="uri">https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html#sklearn.linear_model.ElasticNet</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a href="https://scikit-learn.org/stable/modules/linear_model.html#polynomial-regression-extending-linear-models-with-basis-functions" class="uri">https://scikit-learn.org/stable/modules/linear_model.html#polynomial-regression-extending-linear-models-with-basis-functions</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tong-zeng\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="tong-zeng/tong-zeng.github.io" data-repo-id="R_kgDOLGMgPA" data-category="Announcements" data-category-id="DIC_kwDOLGMgPM4Cch3I" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="light">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../blogs/clustering/index.html" class="pagination-link" aria-label="Clustering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Clustering</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../blogs/classification/index.html" class="pagination-link" aria-label="Classification">
        <span class="nav-page-text">Classification</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Linear and Nonlinear Regression"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Tong Zeng"</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-11-15"</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Regression, Deep Learning, Supervised Learning]</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "img/regression.jpg"</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> House prices prediction with linear and nonlinear models</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>::: column-screen</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/regression.jpg)</span>{.content-header-full-img}</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:right; font-size:0.66em"&gt;</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>Image source: https://www.freepik.com</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>In this blog, we're going to solve the House Prices Prediction problem with linear and nonlinear regression models. Regression is one of the most important machine learning (ML) algorithm, it is very straightforward and intuitive. It is usually the first algorithm we encounter in our machine learning journey, so let's conquer it together!</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>We're going to cover the following regression models in this post:</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Linear Models</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Linear Regression</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ridge Regression</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Lasso Regression</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Elastic Net Regression</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nonlinear Models</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Polynomial Regression</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Artificial Neural Network</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>The dataset used in this blog is downloaded from <span class="co">[</span><span class="ot">Kaggle USA Housing</span><span class="co">](https://www.kaggle.com/datasets/vedavyasv/usa-housing?select=USA_Housing.csv)</span>. The whole dataset is about 5000 rows and 7 columns stored in the csv format, a local downloaded copy could be found as &lt;a href="data/USA_Housing.csv"&gt;USA_Housing.csv&lt;/a&gt; file.</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exploratory Data Analysis</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>We first conduct some exploratory data analysis. We're going to use the pandas library to load and process data, and use the matplotlib and seaborn library for data visualizations.</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Import Libraries</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hvplot.pandas</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Load Data</span></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-head-of-dataset</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Samples of the dataset</span></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-column: page</span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>housing_df <span class="op">=</span> pd.read_csv(<span class="st">'data/USA_Housing.csv'</span>)</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>housing_df.head()</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>As we can see in the @tbl-head-of-dataset, there are 6 numeric columns represents the average area income, house age, number of rooms, number of bedrooms, area population and price, respectively. There is only 1 textual column, keeps the house address.</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>Our goal is modeling the house price, so it should be the dependent variable in the regressions, and all the other columns should be treated as the independent variable.</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>We now have a quick examination of the descriptive statistics.</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-column: body-outset</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>housing_df.describe()</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>In order to have better insights on the variables, we further visualize the data distributions as follows.</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-data-distr</span></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: The data distribution of variables</span></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-column: page</span></span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>sns.pairplot(housing_df)</span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>As @tbl-head-of-dataset shows, most of our variables are normal distributed, except for the average number of bedrooms, there is clearly some linear trends between the dependent variable <span class="in">`Price`</span> and other variables.</span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a>housing_df.hvplot.hist(<span class="st">'Price'</span>)</span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a>We further examine the relations between the dependent variable, for instance, we plot the relationship between <span class="in">`Price`</span> and <span class="in">`Avg. Area Income`</span> interactively as below.</span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a>housing_df.hvplot.scatter(x<span class="op">=</span><span class="st">'Avg. Area Income'</span>, y<span class="op">=</span><span class="st">'Price'</span>)</span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Correlation Coefficient</span></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-corr</span></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: The plot of Correlation Coefficient</span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap-location: bottom</span></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a>axes_arr <span class="op">=</span> sns.heatmap(</span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a>  housing_df[[</span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a>    col <span class="cf">for</span> col <span class="kw">in</span> housing_df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"Address"</span>,<span class="st">"Price"</span>]</span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a>    ]].corr()</span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a>As it is clearly shown in @fig-corr, the <span class="in">`Avg. Area Income`</span> is most correlated with <span class="in">`Price`</span>, followed by <span class="in">`Avg. Area House Age`</span>, <span class="in">`Area Population`</span>, <span class="in">`Avg. Area Number of Rooms`</span>. The variable <span class="in">`Avg. Area Number of Bedrooms`</span> has the smallest correlation score at 0.17. Thus, we will include all these variables in the modeling section.</span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a><span class="fu">### Preprocessing</span></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a>In order to fully exploit the linear regression, especially for better interpretability, we have to check if our data satisfies some criteria for linear regression application. For example:</span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Linear Assumption. The linear regression models assume there are linear relationship between the dependent variable and independent variables.</span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Noise Removal. The noises (i.e., missing value, outliers) in data could potentially impair the model performance, we have to remove these noise before modeling.</span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Gaussian Distribution. Linear regression works well with data comply with gaussian distribution. For those not, we have to apply data transformation techniques (e.g., log transform, BoxCox) to make the data more gaussian distributed.</span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variable Scaling. If variable values are at different magnitudes, we need to scale them to the same magnitudes by using standardization or normalization.</span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a>We have already tested the linear assumption and gaussian distribution in the exploratory data analysis section. And the data is relatively clean, noise is not a problem, however, the value of variables are at different magnitude, we will perform re-scaling before modeling steps.</span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'std_scalar'</span>, StandardScaler())</span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> housing_df[[</span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a>    col <span class="cf">for</span> col <span class="kw">in</span> housing_df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"Address"</span>,<span class="st">"Price"</span>] </span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> housing_df[<span class="st">'Price'</span>].to_numpy()</span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> pipeline.fit_transform(X)</span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(X_scaled).describe()</span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Split</span></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a>Before the modeling steps, we first the dataset into train, validation and test split. We will use sklearn to perform this task.</span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">666</span>)</span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The size of train split: </span><span class="sc">{</span><span class="bu">len</span>(X_train)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The size of test split: </span><span class="sc">{</span><span class="bu">len</span>(X_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modeling</span></span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a>In this section, we will first introduce the model evaluation metrics and then modeling the data using various of regression algorithms.</span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a><span class="fu">### Evaluation</span></span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a>There are several popular evaluation metrics which are widely used in regression problem.</span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **RMSE**</span></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a>**Root Mean Squared Error** (RMSE) is the square root of the mean of the squared errors:</span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a>\operatorname{RMSE}= \sqrt{\frac{1}{n}\sum_{i=1}^n(\hat{y_i} - y_i)^2}</span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a>where,</span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$x_i$ = independent variable of each data point</span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y_i$ = dependent variable of each data point</span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{y}$ = mean of $y$ value</span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\hat{y_i}$ = the predict $y$ value base on $x$</span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **R-Squared (R²) Score**</span></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a>$R^2$ describes the proportion of dependent variance explained by the regression model<span class="ot">[^1]</span>. It could be denoted by the following equation.</span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: &lt;https://en.wikipedia.org/wiki/Coefficient_of_determination&gt;</span></span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a>\operatorname{R^2} = \frac{SSR}{SST}</span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a>where,</span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SSR = \sum_{i=1}^n \left(\hat{y_i} - \bar{y}\right)^2$</span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\operatorname{SST} = \sum_{i=1}^n \left(y_i - \bar{y}\right)^2$</span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Evaluation using Sklearn</span></span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_evaluate(true, predicted):  </span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a>    rmse <span class="op">=</span> np.sqrt(metrics.mean_squared_error(true, predicted))</span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a>    r2_square <span class="op">=</span> metrics.r2_score(true, predicted)</span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'RMSE:'</span>, rmse)</span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'R2 Square'</span>, r2_square)</span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'__________________________________'</span>)</span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate(true, predicted):</span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a>    rmse <span class="op">=</span> np.sqrt(metrics.mean_squared_error(true, predicted))</span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a>    r2_square <span class="op">=</span> metrics.r2_score(true, predicted)</span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rmse, r2_square</span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Models</span></span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Regression</span></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a>We now train a linear regression model using sklearn library.</span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Training**</span></span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a>linear_md <span class="op">=</span> LinearRegression()</span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a>linear_md.fit(X_train, y_train)</span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a>After the fit, we completed the model train. The next step is verify the fitting result and evaluate the model performance.</span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Interpreting**</span></span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a>We can access the model intercept and coefficients using the sklearn API:</span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The intercept is: </span><span class="sc">{</span>linear_md<span class="sc">.</span>intercept_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a>coef_df <span class="op">=</span> pd.DataFrame(linear_md.coef_, X.columns, columns<span class="op">=</span>[<span class="st">'Coefficient'</span>])</span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a>coef_df</span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Prediction**</span></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a>Predict using the model</span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> linear_md.predict(X_test)</span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'True Values'</span>: y_test, <span class="st">'Predicted Values'</span>: pred}).hvplot.scatter(x<span class="op">=</span><span class="st">'True Values'</span>, y<span class="op">=</span><span class="st">'Predicted Values'</span>)</span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a>The residual histogram is plotted as following:</span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'Error Values'</span>: (y_test <span class="op">-</span> pred)}).hvplot.kde()</span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Performance</span></span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> linear_md.predict(X_train)</span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> linear_md.predict(X_test)</span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ridge Regression</span></span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a>Ridge regression is a type of regularized linear regression, it imposes a penalty on the size of the coefficients, it could be expressed using the equation<span class="ot">[^2]</span>:</span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: &lt;https://scikit-learn.org/stable/modules/linear_model.html#ridge-regression&gt;</span></span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a>\min_{w} || X w - y||_2^2 + \alpha ||w||_2^2</span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a>The parameter $\alpha$ controls the amount of the penalty, the larger the $\alpha$, the more penalty is imposed, the coefficient is more shrink to 0.</span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a>Similar to linear regression, we do modeling and evaluation using the ridge regression as following:</span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a>ridge_md <span class="op">=</span> Ridge(alpha <span class="op">=</span> <span class="dv">20</span>,  solver<span class="op">=</span><span class="st">'cholesky'</span>,  tol<span class="op">=</span><span class="fl">0.0001</span>, random_state<span class="op">=</span><span class="dv">666</span>)</span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a>ridge_md.fit(X_train, y_train)</span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> ridge_md.predict(X_train)</span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> ridge_md.predict(X_test)</span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lasso Regression</span></span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a>Ridge regression is another type of regularized linear regression, specifically, using L1 regularization. It adds the absolute value of the coefficient to the loss function as the penalty. Mathematically, it could be expressed using the equation<span class="ot">[^3]</span>:</span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: &lt;https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html#sklearn.linear_model.Lasso&gt;</span></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a>\min_{w} { \frac{1}{2n_{\text{samples}}} ||X w - y||_2 ^ 2 + \alpha ||w||_1}</span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a>The parameter $\alpha$ is a constant which controls the amount of the penalty, the $||w||_1$ is the $\ell_1$-norm of the coefficients.</span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a>Lasso Regression modeling and performance evaluation is performed bellow:</span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a>lasso_md <span class="op">=</span> Lasso(alpha <span class="op">=</span> <span class="fl">0.08</span>, selection<span class="op">=</span><span class="st">'random'</span>, positive<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">888</span>)</span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a>lasso_md.fit(X_train, y_train)</span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> lasso_md.predict(X_train)</span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> lasso_md.predict(X_test)</span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a><span class="fu">### Elastic Net Regression</span></span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a>Elastic net regression is essentially a combination of Ridge and Lasso regression. As it adds two regularization term: L2 and L1 regularization which is used in Ridge and Lasso regression respectively. The trade-off between Ridge and Lasso allows elastic net regression picks up the advantages of these two models. The lost function is written as<span class="ot">[^4]</span>:</span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: &lt;https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html#sklearn.linear_model.ElasticNet&gt;</span></span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a>\min_{w}{\frac{1}{2n_{samples}} \big|\big|X w - y\big|\big|_2 ^ 2 + \alpha \rho \big|\big|w\big|\big|_1 + \frac{\alpha(1-\rho)}{2} \big|\big|w\big|\big|_2 ^ 2}</span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a>The parameters <span class="in">`alpha`</span> $\alpha$ and <span class="in">`l1_ratio`</span> $\rho$ could be decided by cross-validation.</span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> ElasticNet</span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a>enet_md <span class="op">=</span> ElasticNet(alpha<span class="op">=</span><span class="fl">0.08</span>, l1_ratio<span class="op">=</span><span class="fl">0.9</span>, selection<span class="op">=</span><span class="st">'random'</span>, random_state<span class="op">=</span><span class="dv">666</span>)</span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a>enet_md.fit(X_train, y_train)</span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> enet_md.predict(X_train)</span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> enet_md.predict(X_test)</span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nonlinear Models</span></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a>All the model introduce above are belong to linear category. However, linear models is not designed to capture nonlinear trends in the data. If the relationship between dependent variable and independent variables are not linear, we have to apply nonlinear models. Among various options, polynomial regression and artificial neural network are the popular ones.</span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a><span class="fu">### Polynomial Regression</span></span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a>Polynomial regression is a extension to linear regression by introducing polynomial terms. Recall the linear regression model looks like<span class="ot">[^5]</span>:</span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: &lt;https://scikit-learn.org/stable/modules/linear_model.html#polynomial-regression-extending-linear-models-with-basis-functions&gt;</span></span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a>\hat{y}(w, x) = w_0 + w_1 x_1 + w_2 x_2</span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a>However, we can add quadratic term to the previous equation to fit a parabola instead of a plane, then it looks like:</span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a>    \hat{y}(w, x) = w_0 + w_1 x_1 + w_2 x_2 + w_3 x_1 x_2 + w_4 x_1^2 + w_5 x_2^2</span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a>We can new image creating a set of features as:</span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a>z = <span class="co">[</span><span class="ot">x_1, x_2, x_1 x_2, x_1^2, x_2^2</span><span class="co">]</span></span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a>Then, we combine the features and coefficients linearly, and get the following:</span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a>\hat{y}(w, z) = w_0 + w_1 z_1 + w_2 z_2 + w_3 z_3 + w_4 z_4 + w_5 z_5</span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modeling</span></span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a>poly_md <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a>X_train_2_d <span class="op">=</span> poly_md.fit_transform(X_train)</span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a>X_test_2_d <span class="op">=</span> poly_md.transform(X_test)</span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a>linear_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a>linear_reg.fit(X_train_2_d, y_train)</span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Performance</span></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> linear_reg.predict(X_train_2_d)</span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a>pred_test <span class="op">=</span> linear_reg.predict(X_test_2_d)</span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The train set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_train, pred_train)</span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a>print_evaluate(y_test, pred_test)</span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a><span class="fu">### Artificial Neural Network</span></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a>Artificial Neural Network is a very powerful model to fit linear and nonlinear data. In this section, we will use pytorch framework to build a artificial neural network to predict the house prices. Similar to previous models, we start from build the network, then train the models and report the performance in the end.</span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Network Construction</span></span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a>Import the libraries:</span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> Dataset, DataLoader</span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a>Define the <span class="in">`HousePriceDataset`</span> by extending pytorch's <span class="in">`Dataset`</span> class, it is simply convert the numpy array to pytorch tensor.</span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HousePriceDataset(Dataset):</span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, X, Y):</span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.X <span class="op">=</span> torch.tensor(X, dtype<span class="op">=</span>torch.float32)</span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.y <span class="op">=</span> torch.tensor(Y, dtype<span class="op">=</span>torch.float32)</span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.X)</span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, index):</span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="va">self</span>.X[index], <span class="va">self</span>.y[index])</span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a>We new create the <span class="in">`DataLoader`</span> objects, which load the data in batch to feed into the neural network.</span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a>train_ds <span class="op">=</span> HousePriceDataset(X_train, y_train)</span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a>test_ds <span class="op">=</span> HousePriceDataset(X_test, y_test)</span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a>trainloader <span class="op">=</span> DataLoader(train_ds, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a>                         num_workers<span class="op">=</span><span class="dv">2</span>, drop_last<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a>testloader <span class="op">=</span> DataLoader(test_ds, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">True</span>, num_workers<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a>                        drop_last<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a>The code below creates the neural network. It consist of several feed-forward layer with dropout regularization and use RELU as activate function. Each layer is like a linear regression, and the activate function map the output into the nonlinear space. That is why neural network could be used as a nonlinear regressor.</span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MLP(nn.Module):</span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a>    <span class="bu">super</span>(MLP, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.layers <span class="op">=</span> nn.Sequential(</span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">5</span>, <span class="dv">64</span>),</span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a>        nn.Dropout(<span class="fl">0.2</span>),</span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a>        nn.ReLU(),</span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">64</span>, <span class="dv">128</span>),</span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a>        nn.Dropout(<span class="fl">0.2</span>),</span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a>        nn.ReLU(),</span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">128</span>, <span class="dv">64</span>),</span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a>        nn.Dropout(<span class="fl">0.2</span>),</span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a>        nn.ReLU(),</span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a>        nn.Linear(<span class="dv">64</span>, <span class="dv">1</span>)</span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.layers(x)</span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Training</span></span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a>We first implement the evaluate function which loads the test data, pass it to the pre-trained model and reports the <span class="in">`MSE`</span> and $R^2$ as performance metrics.</span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-545"><a href="#cb44-545" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate(model):</span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a>    pred_list <span class="op">=</span> []</span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a>    label_list <span class="op">=</span> []</span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a>    loss_list <span class="op">=</span> []</span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a>    loss_function <span class="op">=</span> nn.MSELoss()</span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, data <span class="kw">in</span> <span class="bu">enumerate</span>(testloader):</span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get inputs</span></span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a>        inputs, targets <span class="op">=</span> data</span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform forward pass</span></span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> outputs.squeeze(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> loss_function(outputs, targets)</span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a>        loss_list.append(loss.item())</span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a>        pred_list.append(outputs.detach().numpy())</span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a>        label_list.append(targets.numpy())</span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a>    avg_loss <span class="op">=</span> <span class="bu">sum</span>(loss_list) <span class="op">/</span> <span class="bu">len</span>(testloader)</span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a>    pred_np <span class="op">=</span> np.vstack(pred_list)</span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a>    label_np <span class="op">=</span> np.vstack(label_list)</span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a>    avg_r2 <span class="op">=</span> metrics.r2_score(pred_np, label_np)</span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (avg_loss, avg_r2)</span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-568"><a href="#cb44-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-569"><a href="#cb44-569" aria-hidden="true" tabindex="-1"></a>The then implements the train function to manage the whole training process, it initialize the neural network, data loader, loss function and the optimizer. Data is passed forward in the network and errors are propagated backward in the network.</span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train():</span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a>    mlp <span class="op">=</span> MLP()</span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a>    torch.manual_seed(<span class="dv">666</span>)</span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a>    trainloader <span class="op">=</span> DataLoader(train_ds, batch_size<span class="op">=</span><span class="dv">32</span>, shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a>                             num_workers<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a>    loss_function <span class="op">=</span> nn.MSELoss()</span>
<span id="cb44-580"><a href="#cb44-580" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(mlp.parameters(), lr<span class="op">=</span><span class="fl">6e-4</span>)</span>
<span id="cb44-581"><a href="#cb44-581" aria-hidden="true" tabindex="-1"></a>    n_epochs <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a>    mlp.train()</span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a>    train_loss_list <span class="op">=</span> []</span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a>    train_r2_list <span class="op">=</span> []</span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a>    test_loss_list <span class="op">=</span> []</span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a>    test_r2_list <span class="op">=</span> []</span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(n_epochs):</span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a>        pred_list <span class="op">=</span> []</span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a>        label_list <span class="op">=</span> []</span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a>        loss_list <span class="op">=</span> []</span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, data <span class="kw">in</span> <span class="bu">enumerate</span>(trainloader):</span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a>            inputs, targets <span class="op">=</span> data</span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Zero the gradients</span></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()</span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Perform forward pass</span></span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> mlp(inputs)</span>
<span id="cb44-597"><a href="#cb44-597" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> outputs.squeeze(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Compute loss</span></span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_function(outputs, targets)</span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Perform backward pass</span></span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Perform optimizationd</span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Print statistics    </span></span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a>            pred_list.append(outputs.detach().numpy())</span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a>            label_list.append(targets.numpy())</span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a>            loss_list.append(loss.item())</span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a>        avg_loss <span class="op">=</span> <span class="bu">sum</span>(loss_list) <span class="op">/</span> <span class="bu">len</span>(trainloader)</span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a>        pred_np <span class="op">=</span> np.vstack(pred_list)</span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a>        label_np <span class="op">=</span> np.vstack(label_list)</span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a>        avg_r2 <span class="op">=</span> metrics.r2_score(pred_np, label_np)</span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a>        train_loss_list.append(avg_loss)</span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a>        train_r2_list.append(avg_r2)</span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a>        test_loss, test_r2 <span class="op">=</span> evaluate(mlp)</span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a>        test_loss_list.append(test_loss)</span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a>        test_r2_list.append(test_r2)</span>
<span id="cb44-618"><a href="#cb44-618" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"epoch: </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">, test_loss: </span><span class="sc">{</span>test_loss<span class="sc">}</span><span class="ss">, test_r2: </span><span class="sc">{</span>test_r2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb44-619"><a href="#cb44-619" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Training process has finished.'</span>)</span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mlp, train_loss_list, train_r2_list, test_loss_list, test_r2_list</span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a>Start the training process:</span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a>model, train_loss_list, train_r2_list, test_loss_list, test_r2_list <span class="op">=</span> train()</span>
<span id="cb44-630"><a href="#cb44-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-631"><a href="#cb44-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Evaluation</span></span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-634"><a href="#cb44-634" aria-hidden="true" tabindex="-1"></a>Similar to previous model, we reports the <span class="in">`RMSE`</span> and <span class="in">`R^2`</span> of the test set as the evaluation metrics:</span>
<span id="cb44-635"><a href="#cb44-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a>test_loss, test_r2 <span class="op">=</span> evaluate(model)</span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The test set performance:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a>rmse <span class="op">=</span> np.sqrt(test_loss)</span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'RMSE:'</span>, rmse)</span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'R2 Square'</span>, test_r2)</span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'__________________________________'</span>)</span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-650"><a href="#cb44-650" aria-hidden="true" tabindex="-1"></a>train_loss <span class="op">=</span> train_loss_list</span>
<span id="cb44-651"><a href="#cb44-651" aria-hidden="true" tabindex="-1"></a>val_loss <span class="op">=</span> test_loss_list</span>
<span id="cb44-652"><a href="#cb44-652" aria-hidden="true" tabindex="-1"></a>train_r2 <span class="op">=</span> train_r2_list</span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a>val_r2 <span class="op">=</span> test_r2_list</span>
<span id="cb44-654"><a href="#cb44-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-655"><a href="#cb44-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a>Further, we can visualize the the <span class="in">`RMSE`</span> of the train and test split during the whole training process, which is shown as follows:</span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw loss plot</span></span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a>plt.plot(train_loss, label<span class="op">=</span><span class="st">'Training Loss'</span>)</span>
<span id="cb44-665"><a href="#cb44-665" aria-hidden="true" tabindex="-1"></a>plt.plot(val_loss, label<span class="op">=</span><span class="st">'Validation Loss'</span>)</span>
<span id="cb44-666"><a href="#cb44-666" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Batch'</span>)</span>
<span id="cb44-667"><a href="#cb44-667" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb44-668"><a href="#cb44-668" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb44-669"><a href="#cb44-669" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Loss'</span>)</span>
<span id="cb44-670"><a href="#cb44-670" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb44-671"><a href="#cb44-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-672"><a href="#cb44-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-673"><a href="#cb44-673" aria-hidden="true" tabindex="-1"></a>The $R^2$ of the train and test split during the whole training process is shown as follows:</span>
<span id="cb44-674"><a href="#cb44-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-677"><a href="#cb44-677" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb44-678"><a href="#cb44-678" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw accuracy plot</span></span>
<span id="cb44-679"><a href="#cb44-679" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb44-680"><a href="#cb44-680" aria-hidden="true" tabindex="-1"></a>plt.plot(train_r2[<span class="dv">10</span>:], label<span class="op">=</span><span class="st">'Training Accuracy'</span>)</span>
<span id="cb44-681"><a href="#cb44-681" aria-hidden="true" tabindex="-1"></a>plt.plot(val_r2[<span class="dv">10</span>:], label<span class="op">=</span><span class="st">'Validation Accuracy'</span>)</span>
<span id="cb44-682"><a href="#cb44-682" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Batch'</span>)</span>
<span id="cb44-683"><a href="#cb44-683" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb44-684"><a href="#cb44-684" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb44-685"><a href="#cb44-685" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Accuracy'</span>)</span>
<span id="cb44-686"><a href="#cb44-686" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb44-687"><a href="#cb44-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-688"><a href="#cb44-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-689"><a href="#cb44-689" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion and Conclusion</span></span>
<span id="cb44-690"><a href="#cb44-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-691"><a href="#cb44-691" aria-hidden="true" tabindex="-1"></a>In this blog, we applied 4 linear regression models and 2 nonlinear regression models in predicting the house price. Although trained on the same training set, these models vary in performance and have different characteristics in training.</span>
<span id="cb44-692"><a href="#cb44-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-693"><a href="#cb44-693" aria-hidden="true" tabindex="-1"></a>Linear or nonlinear regression should I use? The choice between linear regression and nonlinear regression depends on the underlying relationship between the independent and dependent variables in your dataset. Here are some guidelines can be summarized from our previous experiments:</span>
<span id="cb44-694"><a href="#cb44-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-695"><a href="#cb44-695" aria-hidden="true" tabindex="-1"></a>**Linearity of the Relationship:**</span>
<span id="cb44-696"><a href="#cb44-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-697"><a href="#cb44-697" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use linear regression when the relationship between the independent and dependent variables appears to be linear. Linear regression models assume a straight-line relationship, and they are suitable when the data points seem to follow a linear pattern.</span>
<span id="cb44-698"><a href="#cb44-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-699"><a href="#cb44-699" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use nonlinear regression when the relationship is not linear. If the data exhibits a curve, exponential growth, decay, or any other nonlinear pattern, a nonlinear regression model may be more appropriate.</span>
<span id="cb44-700"><a href="#cb44-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-701"><a href="#cb44-701" aria-hidden="true" tabindex="-1"></a>**Model Complexity:**</span>
<span id="cb44-702"><a href="#cb44-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-703"><a href="#cb44-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Linear regression models are simpler and easier to interpret. If a linear relationship adequately describes the data, it's often preferable due to its simplicity.</span>
<span id="cb44-704"><a href="#cb44-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-705"><a href="#cb44-705" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nonlinear regression models can capture more complex relationships but may be harder to interpret. Be cautious about overfitting, where a model captures noise in the data rather than the underlying pattern.</span>
<span id="cb44-706"><a href="#cb44-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-707"><a href="#cb44-707" aria-hidden="true" tabindex="-1"></a>As the house price data we used has a simple linear pattern, so, the performance is has no big difference than the nonlinear models. But it is much simple to implement and requires much less time and resource for training. In this kind of scenario, linear regression could be a good choice.</span>
<span id="cb44-708"><a href="#cb44-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-709"><a href="#cb44-709" aria-hidden="true" tabindex="-1"></a>In summary, the decision to use linear or nonlinear regression depends on the characteristics of your data and the underlying relationship between variables.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Powered by <a href="https://quarto.org/" target="_blank">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
<p>Copyright © 2024 TONG ZENG. ALL RIGHTS RESERVED.</p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>